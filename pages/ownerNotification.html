<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OwnerNotification</title>
    <link rel="stylesheet" href="../assets/css/ownerhome.css">
    <link rel="stylesheet" href="../assets/css/ownerNotification.css">

</head>

<body>

</body>
<header>
    <div>
        <img src="../assets/Images/Logo.png" alt="Logo">
    </div>

    <nav>
        <div>
            <a onclick="urlNotif()">Requirement List</a>
            <!-- <a>Search</a> -->
            <a href="">Chat</a>
            <a>Notification</a>
            <a onclick="urlData()" href="profile.html">profile</a>
            <a href="../index.html">LogOut</a>
        </div>
    </nav>
</header>

<main>
    <section>
        <div class="notificationEntire">
            <div class="notificationTop">

                <div class="profile">
                    <img src="../assets/Images/avatar (3).svg" alt="image" />
                    <p class="user_name">kamalesh</p>

                </div>

                <div class="types">
                    <div onclick="filterAll()">
                        All
                    </div>
                    <div onclick="filterRead()">
                        Read
                    </div>
                    <div onclick="filterUnread()">
                        Unread
                    </div>
                </div>
            </div>


            <!-- <div class="notifications">
                <div class="notifyCards">
                    <img src="../assets/Images/boy-avatar.svg" alt="Image">
                    <div class="applierDetails">
                        <p class="name">Worker Name : kamalesh</p>
                        <p class="jobId">Job Id : 0987654321wertyu</p>
                    </div>
                    <div class="buttons">
                        <div class="b1">
                            <a>Approve</a>
                            <a>Reject</a>
                        </div>
                        <div class="b2">
                            <a>Readed</a>
                            <a>Details</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="notifications">
                <div class="notifyCards">
                    <img src="../assets/Images/boy-avatar.svg" alt="Image">
                    <div class="applierDetails">
                        <p class="name">Worker Name : kamalesh</p>
                        <p class="jobId">Job Id : 0987654321wertyu</p>
                    </div>
                    <div class="buttons">
                        <a>Approve</a>
                        <a>Reject</a>
                        <a>Readed</a>
                    </div>
                </div>
            </div> -->

            <!-- <div class="notifications">
                <div class="notifyCards">
                    <img src="../assets/Images/boy-avatar.svg" alt="Image">
                    <div class="applierDetails">
                        <p class="name">Worker Name : kamalesh</p>
                        <p class="jobId">Worker Id : 0987654321wertyu</p>
                    </div>
                    <div class="buttons">
                        <a>Approve</a>
                        <a>Reject</a>
                        <a>Readed</a>
                    </div>
                </div>
            </div> -->
        </div>



    </section>

    <section class="secS">
        <!-- <div class="details">
            <div class="jobHead">
                <div class="p">
                    <p>Job Title: JOBTITLE</p>
                    <p>Location: LOCATION</p>
                    <p>Worker Name: Kamalesh</p>
                </div>
                <div>
                    <img src="../assets/Images/close.svg" alt="image" />
                </div>
            </div>
            <div class="data">
                <div class="jobSummary">
                    <p class="title">
                        Job Summary
                    </p>
                    <ul>
                        <li>
                            These include a clear understanding of the client's needs and goals, a solid plan for
                            designing and building the website, expertise in the necessary programming
                        </li>

                        <li>Web development requirements vary depending on the specific project and goals, but there are
                            some general requirements that apply to most web development projects</li>

                        <li>Other important requirements may include effective communication and collaboration with
                            clients and team members, attention to detail, and a commitment to ongoing testing and
                            optimization to ensure the website functions as intended</li>

                        <li>Ultimately, successful web development requires a combination of technical expertise,
                            creativity, and effective project management skills</li>
                    </ul>
                </div>

                <div class="Qualification">
                    <p class="title">
                        Qualifications
                    </p>
                    <ul>
                        <li>
                            These include a clear understanding of the client's needs and goals, a solid plan for
                            designing and building the website, expertise in the necessary programming
                        </li>

                        <li>Web development requirements vary depending on the specific project and goals, but there are
                            some general requirements that apply to most web development projects</li>

                        <li>Other important requirements may include effective communication and collaboration with
                            clients and team members, attention to detail, and a commitment to ongoing testing and
                            optimization to ensure the website functions as intended</li>

                        <li>Ultimately, successful web development requires a combination of technical expertise,
                            creativity, and effective project management skills</li>
                    </ul>
                </div>

                <div class="Responsibilitie">
                    <p class="title">
                        Responsibilities
                    </p>
                    <ul>
                        <li>
                            These include a clear understanding of the client's needs and goals, a solid plan for
                            designing and building the website, expertise in the necessary programming
                        </li>

                        <li>Web development requirements vary depending on the specific project and goals, but there are
                            some general requirements that apply to most web development projects</li>

                        <li>Other important requirements may include effective communication and collaboration with
                            clients and team members, attention to detail, and a commitment to ongoing testing and
                            optimization to ensure the website functions as intended</li>

                        <li>Ultimately, successful web development requires a combination of technical expertise,
                            creativity, and effective project management skills</li>
                    </ul>
                </div>
            </div>
        </div> -->

    </section>
</main>
<script>

    //  Notification

    // filters

    function filterAll() {
        location.href = "ownerNotification.html?from=logIn&&type=owner&filter=all";

    }

    function filterRead() {
        location.href = "ownerNotification.html?from=logIn&&type=owner&filter=readed";
    }

    function filterUnread() {
        location.href = "ownerNotification.html?from=logIn&&type=owner&filter=unreaded";

    }




    function urlNotif() {
        // let url = location.search;
        location.href = "ownerHome.html?from=logIn&&type=owner&filter=all";
    }

    // url data


    let url = location.search;
    let urlParams = new URLSearchParams(url);
    let filter = urlParams.get("filter");
    console.log(filter);

    let getApplyJOb = JSON.parse(localStorage.getItem("apllyJob"))
    console.log(getApplyJOb);
    let currentOwner = JSON.parse(localStorage.getItem("Login"))
    console.log(currentOwner.id);
    console.log(getApplyJOb);


    let applyJobAll = getApplyJOb.filter((J) => J["ownerId"] == currentOwner.id);
    console.log(applyJobAll);
    let applyJobReaded = applyJobAll.filter((J) => J["readed"] == true);
    console.log(applyJobReaded);
    let applyJobUnread = applyJobAll.filter((J) => J["readed"] == false);
    console.log(applyJobUnread);
    let applyJob;
    if (filter == "all") {
        applyJob = applyJobAll;
    }
    else if (filter == "readed") {
        applyJob = applyJobReaded;
    }
    else {
        applyJob = applyJobUnread;
    }
    console.log(applyJob)



    for (let i = 0; i < applyJob.length; i++) {
        let notifications = document.createElement("div");
        notifications.setAttribute("class", "notifications");

        let notifyCards = document.createElement("div");
        notifyCards.setAttribute("class", "notifyCards");
        notifications.append(notifyCards);

        let notifyCardsImage = document.createElement("img");
        notifyCardsImage.setAttribute("src", "../assets/Images/boy-avatar.svg");
        notifyCardsImage.setAttribute("alt", "Image");
        notifyCards.append(notifyCardsImage);

        let applierDetails = document.createElement("div");
        applierDetails.setAttribute("class", "applierDetails");
        notifyCards.append(applierDetails);

        let name = document.createElement("p");
        name.setAttribute("class", "name");
        name.innerHTML = `${applyJob[i]["applierName"]}`;
        applierDetails.append(name);

        let jobId = document.createElement("p");
        jobId.innerHTML = `Job Id : ${applyJob[i]["jobID"]}`;
        jobId.setAttribute("class", "jobId");
        applierDetails.append(jobId);

        let buttons = document.createElement("div");
        buttons.setAttribute("class", "buttons");
        notifyCards.append(buttons);

        let b1 = document.createElement("div");
        b1.setAttribute("class", "b1");
        buttons.append(b1);


        let Approve = document.createElement("a");
        Approve.innerHTML = "Approve";
        b1.append(Approve);

        let Reject = document.createElement("a");
        Reject.innerHTML = "Reject";
        b1.append(Reject);

        let b2 = document.createElement("div");
        b2.setAttribute("class", "b2");
        buttons.append(b2);

        let Readed = document.createElement("a");
        Readed.innerHTML = "Readed";
        Readed.setAttribute("onclick", "readed()")
        b2.append(Readed);

        let details = document.createElement("a");
        details.innerHTML = "Details";
        details.setAttribute("onclick", `setCurrentNotificationId(${applyJob[i]["aplliedJobId"]})`)
        // details.setAttribute("onclick", "oncDetails()")
        b2.append(details);

        document.querySelector(".notificationEntire").append(notifications);
    }


    function readed() {
        let CurrentNotificationId = JSON.parse(localStorage.getItem("CurrentNotificationId"));
        let appliedJobs = JSON.parse(localStorage.getItem("apllyJob"));
        let findexObject = appliedJobs.find(f => f.aplliedJobId == CurrentNotificationId)
        let index = appliedJobs.indexOf(findexObject);
        console.log(findexObject);
        let readed = {
            readed: true,
        }

        console.log(readed);
        let AddedfindexObject = Object.assign(findexObject, readed);
        console.log(AddedfindexObject, "AddedfindexObject");
        console.log(index);
        appliedJobs[index] = AddedfindexObject;
        localStorage.setItem("apllyJob", JSON.stringify(appliedJobs));
    }



    // let url = location.search;
    // let urlParams = new URLSearchParams(url);
    // let CurrentId = urlParams.get("applyId");
    // console.log(CurrentId)
    // console.log(applyJob);

    function setCurrentNotificationId(id) {
        localStorage.setItem("CurrentNotificationId", JSON.stringify(id));
        let CurrentId = JSON.parse(localStorage.getItem("CurrentNotificationId"));
        console.log(CurrentId);
        // let currentJobIndex = applyJob.indexOf(CurrentId);
        // console.log(applyJob);
        // console.log(applyJob["CurrentId"]);
        // console.log(currentJobIndex);
        let currentJob = applyJob.find((A) => A["aplliedJobId"] == CurrentId);
        createDetails(currentJob);
    }


    // console.log(currentJob)
    // Data Details

    function createDetails(currentJob) {
        console.log(currentJob);

        let initial = document.querySelector(".details");
        if (initial != null) {
            document.querySelector(".details").remove();
        }

        // let details = null;
        let details = document.createElement("div");
        details.setAttribute("class", "details");


        let jobHead = document.createElement("div");
        jobHead.setAttribute("class", "jobHead");
        details.append(jobHead);

        let p = document.createElement("div");
        p.setAttribute("class", "p");
        jobHead.append(p);

        let Jtitle = document.createElement("p");
        Jtitle.remove();
        Jtitle.innerHTML = `Job Title:   ${currentJob["title"]}`;
        p.append(Jtitle);

        let Jlocation = document.createElement("p");
        Jlocation.remove();
        Jlocation.innerHTML = `Location:${currentJob["location"]} `;
        p.append(Jlocation);

        let JworkerName = document.createElement("p");
        JworkerName.remove();
        JworkerName.innerHTML = `Worker Name: ${currentJob["applierName"]}`;
        p.append(JworkerName);

        let imageDiv = document.createElement("div")
        jobHead.append(imageDiv);

        let image = document.createElement("img");
        image.setAttribute("src", "../assets/Images/close.svg");
        image.setAttribute("alt", "image");
        image.setAttribute("onclick", "closeDetail()")
        imageDiv.append(image);

        let data = document.createElement("div");
        data.setAttribute("class", "data");
        details.append(data);

        let jobSummary = document.createElement("div");
        jobSummary.setAttribute("class", "jobSummary");
        data.append(jobSummary);

        let title = document.createElement("p");
        title.setAttribute("class", "title");
        title.innerHTML = "Job Summary";
        jobSummary.append(title);

        let jobSummaryUL = document.createElement("ul");
        jobSummaryUL.remove();
        jobSummary.append(jobSummaryUL);


        console.log(currentJob["summary"])
        let getSummary = currentJob["summary"];

        let currentSummary = getSummary.split(".");

        for (let i = 0; i < currentSummary.length - 1; i++) {

            let jobSummaryLi = document.createElement("li");
            jobSummaryLi.innerHTML = currentSummary[i];
            jobSummaryUL.append(jobSummaryLi);
        }


        let Qualification = document.createElement("div");
        Qualification.setAttribute("class", "Qualification");
        data.append(Qualification);

        let QualificationTitle = document.createElement("p");
        QualificationTitle.setAttribute("class", "title");
        QualificationTitle.innerHTML = "Qualifications";
        Qualification.append(QualificationTitle);

        let QualificationUl = document.createElement("ul");
        QualificationUl.remove();
        Qualification.append(QualificationUl);

        let getQualification = currentJob["Qualifications"];
        let currentQualification = getQualification.split(".")

        for (let i = 0; i < currentQualification.length - 1; i++) {
            let QualificationLi = document.createElement("li");
            QualificationLi.innerHTML = currentQualification[i]
            QualificationUl.append(QualificationLi);
        }

        let Responsibilitie = document.createElement("div");
        Responsibilitie.setAttribute("class", "Responsibilitie");
        data.append(Responsibilitie);

        let ResponsibilitieTitle = document.createElement("p");
        ResponsibilitieTitle.setAttribute("class", "title");
        ResponsibilitieTitle.innerHTML = "Responsibilities";
        Responsibilitie.append(ResponsibilitieTitle);

        let ResponsibilitieUl = document.createElement("ul");
        ResponsibilitieUl.remove();
        Responsibilitie.append(ResponsibilitieUl);

        let getResponsibility = currentJob["Responsibilities"]
        let currentResponsibility = getResponsibility.split(".");

        for (let i = 0; i < currentResponsibility.length - 1; i++) {
            let ResponsibilitieLi = document.createElement("li");
            ResponsibilitieLi.innerHTML = currentResponsibility[i];
            ResponsibilitieUl.append(ResponsibilitieLi);
        }

        document.querySelector(".secS").append(details)

        console.log("JS created");

        oncDetails();

    }
    function oncDetails() {
        event.preventDefault();
        let detail = document.querySelector(".secS")
        // console.log(detail + "test")
        detail.style.display = "block";

        let notificationEntire = document.querySelector(".notificationEntire");
        notificationEntire.style.marginLeft = "30%";

    }

    function closeDetail() {
        // event.preventDefault();
        let detail = document.querySelector(".secS")
        // console.log(detail + "test")
        detail.style.display = "none";

        let notificationEntire = document.querySelector(".notificationEntire");
        notificationEntire.style.marginLeft = "100%";
    }







</script>

</html>