<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="../assets/css/owner_profile.css">
</head>

<body>
    <!-- This is worker profile -->
    <section>
        <!-- BioDatas(); -->
        <div class="fullprofile">
            <div>
                <div class="blue">

                </div>
                <div class="white">

                </div>

                <div class="profile">
                    <div>
                        <img alt="image" src="../assets/Images/avatar (4).svg">
                    </div>
                </div>
            </div>
            <div class="second_div_profile">
                <div class="datas">

                </div>
                <div class="top_icons">
                    <div class="icons"> <img src="../assets/Images/phone_new.svg" alt="image" />
                        <p>+919876543210</p>
                    </div>
                    <div class="icons">
                        <img src="../assets/Images/linkedin (1).svg" alt="image" />
                        <p>Linkedin</p>
                    </div>
                    <div class="icons">
                        <img src="../assets/Images/instagram-logo.svg" alt="image" />
                        <p>Instagram</p>
                    </div>
                    <div class="icons">
                        <img src="../assets/Images/gmail (1).svg" alt="image" />
                        <p>Gmail</p>
                    </div>
                </div>
            </div>
        </div>

        <button onclick='location.href = "OwnerHome.html"'>Back</button>
        <a class="edit" href="editProfile.html">Edit</a>
        <a class="delete" onclick="deleteUser()">Delete User</a>
    </section>

    <script>

        let url = location.search;
        let urlParams = new URLSearchParams(url);
        let from = urlParams.get("from");
        console.log(from);

        let BIO = JSON.parse(localStorage.getItem("BIO"));
        console.log(BIO);

        let Email = "";

        if (from == "logIn") {
            let logIn = JSON.parse(localStorage.getItem("Login"));
            Email = logIn[logIn.length - 1]["Email"];
            // console.log()

        }

        else {

            let register = JSON.parse(localStorage.getItem("register"));
            // console.log(register)
            Email = register[register.length - 1]["Email"]
            console.log(Email);
        }

        console.log(Email)

        // let register = JSON.parse(localStorage.getItem("register"));
        // // console.log(register)
        // let Email = register[register.length - 1]["Email"]
        // console.log(Email);


        let userBio = BIO.find(B => B.Email == Email)

        console.log(userBio);

        let expertIn = document.createElement("p");
        expertIn.innerText = "Expert In :  " + userBio.Expect_in;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(expertIn);

        let Current_occupation = document.createElement("p");
        Current_occupation.innerText = "Current_occupation :  " + userBio.Current_occupation;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(Current_occupation);


        let Education = document.createElement("p");
        Education.innerText = "Education :  " + userBio.Education;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(Education);

        let Address = document.createElement("p");
        Address.innerText = "Address :  " + userBio.Address;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(Address);


        let DOB = document.createElement("p");
        DOB.innerText = "DOB :  " + userBio.DOM;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(DOB);


        let Name = document.createElement("p");
        Name.innerText = "Name :  " + userBio.FN + userBio.LN;
        expertIn.setAttribute("class", "second_div_profile_p")
        document.querySelector(".datas").prepend(Name);


        function deleteUser() {
            let email = prompt("Enter your email");

            let password = prompt("Enter your password")

            let BIO = JSON.parse(localStorage.getItem("BIO"));
            let register = JSON.parse(localStorage.getItem("register"))
            let login = JSON.parse(localStorage.getItem("Login"))



            function Email() {
                return email;
            }


            if (localStorage.getItem("BIO") != null) {
                console.log(email);
                let FindedEmail = BIO.find(B => B["Email"] == email);

                if (FindedEmail == undefined) {
                    return alert("User credentials not match");
                }

                let bioIndex = BIO.indexOf(FindedEmail);
                console.log(bioIndex)
                BIO.splice(bioIndex, 1);
                localStorage.setItem("BIO", JSON.stringify(BIO));
            }

            if (localStorage.getItem("Login") != null) {

                console.log("test")
                let FindedEmail = login.find(L => L["Email"] == email);
                let loginIndex = login.indexOf(FindedEmail);
                console.log(loginIndex)
                login.splice(loginIndex, 1);
                localStorage.setItem("Login", JSON.stringify(login));
            }

            if (localStorage.getItem("register") != null) {

                let FindReg = register.find(R => R["Email"] == email);
                let registerIndex = register.indexOf(FindReg);
                console.log(registerIndex);
                register.splice(registerIndex, 1);
                localStorage.setItem("register", JSON.stringify(register));
                location.href = "../index.html";
            }


        }




    </script>

</body>

</html>